<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset='UTF-8'>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>MathObjectsAnswerCheckers</title>
	<link rel="shortcut icon" href="/favicon.ico">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://openwebwork.github.io/pg-docs/pod/assets/podviewer.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" defer></script>
	<script src="https://openwebwork.github.io/pg-docs/pod/assets/podviewer.js" defer></script>
</head>
<body>
	<div class="pod-header navbar navbar-dark bg-primary px-3 position-fixed border-bottom border-dark">
		<div class="container-fluid d-flex flex-column d-md-block">
			<h1 class="navbar-brand fw-bold fs-5 me-auto me-md-0 mb-2 mb-md-0">MathObjectsAnswerCheckers</h1>
			<button class="navbar-toggler d-md-none me-auto" type="button" data-bs-toggle="offcanvas"
				data-bs-target="#sidebar" aria-controls="sidebar" aria-label="Toggle Sidebar">
				<span class="navbar-toggler-icon"></span>
			</button>
		</div>
	</div>
	<aside class="offcanvas-md offcanvas-start border-end border-dark position-fixed" tabindex="-1"
		id="sidebar" aria-labelledby="sidebar-label">
		<div class="offcanvas-header">
			<h2 class="offcanvas-title" id="sidebar-label">Index</h2>
			<button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#sidebar"
			   	aria-label="Close">
			</button>
		</div>
		<div class="offcanvas-body p-md-3 w-100">
			<nav>
				<ul class="nav flex-column w-100">
					<li class="nav-item">
						<a href="https://openwebwork.github.io/pg-docs/pod" class="nav-link p-0">WeBWorK POD Home</a>
					</li>
					<li class="nav-item">
						<a href="http://webwork.maa.org/wiki/WeBWorK_Main_Page" class="nav-link p-0">WeBWorK Wiki</a>
					</li>
					<li><hr></li>
<li class="nav-item"><a class="nav-link p-0" href="#MathObjects-based-Answer-Checkers">MathObjects-based Answer Checkers</a>
    <ul class="nav flex-column w-100">
      <li class="nav-item"><a class="nav-link p-0" href="#Controlling-the-Details-of-the-Answer-Checkers">Controlling the Details of the Answer Checkers</a>
        <ul class="nav flex-column w-100">
          <li class="nav-item"><a class="nav-link p-0" href="#Flags-common-to-all-answer-checkers">Flags common to all answer checkers</a></li>
          <li class="nav-item"><a class="nav-link p-0" href="#Flags-for-Real--cmp">Flags for Real()-&gt;cmp</a></li>
          <li class="nav-item"><a class="nav-link p-0" href="#Flags-for-String--cmp">Flags for String()-&gt;cmp</a></li>
          <li class="nav-item"><a class="nav-link p-0" href="#Flags-for-Point--cmp">Flags for Point()-&gt;cmp</a></li>
          <li class="nav-item"><a class="nav-link p-0" href="#Flags-for-Vector--cmp">Flags for Vector()-&gt;cmp</a></li>
          <li class="nav-item"><a class="nav-link p-0" href="#Flags-for-Matrix--cmp">Flags for Matrix()-&gt;cmp</a></li>
          <li class="nav-item"><a class="nav-link p-0" href="#Flags-for-Interval--cmp">Flags for Interval()-&gt;cmp</a></li>
          <li class="nav-item"><a class="nav-link p-0" href="#Flags-for-Set--cmp-Union--cmp-and-List--cmp">Flags for Set()-&gt;cmp, Union()-&gt;cmp, and List()-&gt;cmp</a></li>
          <li class="nav-item"><a class="nav-link p-0" href="#Flags-for-Formula--cmp">Flags for Formula()-&gt;cmp</a></li>
        </ul>
      </li>
      <li class="nav-item"><a class="nav-link p-0" href="#The-Context-and-Answer-Checkers">The Context and Answer Checkers</a></li>
      <li class="nav-item"><a class="nav-link p-0" href="#Tolerances-and-Limits">Tolerances and Limits</a></li>
      <li class="nav-item"><a class="nav-link p-0" href="#Custom-Answer-Checkers">Custom Answer Checkers</a>
        <ul class="nav flex-column w-100">
          <li class="nav-item"><a class="nav-link p-0" href="#List-based-Answer-Checkers">List-based Answer Checkers</a></li>
          <li class="nav-item"><a class="nav-link p-0" href="#Set-and-Union-Answer-Checkers">Set and Union Answer Checkers</a></li>
        </ul>
      </li>
    </ul>
  </li>				</ul>
			</nav>
		</div>
	</aside>
	<div class="pod-page-container d-flex">
		<div class="container-fluid p-3 h-100" id="_podtop_">


<a href="#_podtop_"><h1 id="MathObjects-based-Answer-Checkers">MathObjects-based Answer Checkers</h1></a>

<p>The MathObject library is designed to be used in two ways. First, you can use it within your perl code when writing problems as a means of making it easier to handle formulas, and in particular, to be able to use a single object to produce numeric values, TeX output, and answer strings from a single formula entry. This avoids having to type a function three different ways (which makes maintaining a problem much harder). Since MathObjects also includes vector and complex arthimetic, it is easier to work with these types of values as well.</p>

<p>Secondly using MathObjects improves the processing of student input. This is accomplished through special answer checkers that are part of the MathObjects package (rather than the traditional WeBWorK answer checkers). Each of these checkers has error checking customized to the type of input expected from the student and can provide helpful feedback if the syntax of the student&#39;s entry is incorrect.</p>

<p>Checkers are available for each of the types of values that the parser can produce (numbers, complex numbers, infinities, points, vectors, intervals, sets, unions, formulas, lists of numbers, lists of points, lists of intervals, lists of formulas returning numbers, lists of formulas returning points, and so on).</p>

<p>To use one of these checkers, simply call the <code>cmp</code> method of the object that represents the correct answer. For example:</p>

<pre><code>$n = Real(sqrt(2));
ANS($n-&gt;cmp);</code></pre>

<p>will produce an answer checker that matches the square root of two. Similarly,</p>

<pre><code>ANS(Vector(1,2,3)-&gt;cmp);</code></pre>

<p>matches the vector <code>&lt;1,2,3&gt;</code> (or any computation that produces it, e.g., <code>i+2j+3k</code>, or <code>&lt;4,4,4&gt;-&lt;3,2,1&gt;</code>), while</p>

<pre><code>ANS(Interval(&quot;(-inf,3]&quot;)-&gt;cmp);</code></pre>

<p>matches the given interval. Other examples include:</p>

<pre><code>ANS(Infinity-&gt;cmp);
ANS(String(&#39;NONE&#39;)-&gt;cmp);
ANS(Union(&quot;(-inf,$a) U ($a,inf)&quot;)-&gt;cmp);</code></pre>

<p>and so on.</p>

<p>Formulas are handled in the same way:</p>

<pre><code>ANS(Formula(&quot;x+1&quot;)-&gt;cmp);

$a = random(-5,5,1); $b = random(-5,5,1); $x = random(-5,5,1);
$f = Formula(&quot;x^2 + $a x + $b&quot;)-&gt;reduce;
ANS($f-&gt;cmp);
ANS($f-&gt;eval(x=&gt;$x)-&gt;cmp);

$x = Formula(&#39;x&#39;);
ANS((1+$a*$x)-&gt;cmp);

Context(&quot;Vector&quot;)-&gt;variables-&gt;are(t=&gt;&#39;Real&#39;);
$v = Formula(&quot;&lt;t,t^2,t^3&gt;&quot;); $t = random(-5,5,1);
ANS($v-&gt;cmp);
ANS($v-&gt;eval(t=&gt;$t)-&gt;cmp);</code></pre>

<p>and so on.</p>

<p>Lists of items can be checked as easily:</p>

<pre><code>ANS(List(1,-1,0)-&gt;cmp);
ANS(List(Point($a,$b),Point($a,-$b))-&gt;cmp);
ANS(List(Vector(1,0,0),Vector(0,1,1))-&gt;cmp);
ANS(Compute(&quot;(-inf,2),(4,5)&quot;)-&gt;cmp); # easy way to get list of intervals
ANS(Formula(&quot;x, x+1, x^2-1&quot;)-&gt;cmp);
ANS(Formula(&quot;&lt;x,2x&gt;,&lt;x,-2x&gt;,&lt;0,x&gt;&quot;)-&gt;cmp);
ANS(List(&#39;NONE&#39;)-&gt;cmp);</code></pre>

<p>and so on. The last example may seem strange, as you could have used <code>ANS(String(&#39;NONE&#39;)-&gt;cmp)</code>, but there is a reason for using this type of construction. You might be asking for one or more numbers (or points, or whatever) or the word <code>NONE</code> if there are no numbers (or points). If you used <code>String(&#39;NONE&#39;)-&gt;cmp</code>, the student would get an error message about a type mismatch if he entered a list of numbers, but with <code>List(&#39;NONE&#39;)-&gt;cmp</code>, he will get appropriate error messages for the wrong entries in the list.</p>

<p>In the case of a list of points where the answer is <code>NONE</code>, you should tell MathObject what the expected type of answer is, so that appropriate messages can be given. E.g.,</p>

<pre><code>ANS(List(&#39;NONE&#39;)-&gt;cmp(typeMatch=&gt;Value::Point);</code></pre>

<p>would give appropriate messages for points rather than numbers (the default type).</p>

<p>It is often appropriate to use the list checker in this way even when the correct answer is a single value, if the student might type a list of answers.</p>

<p>On the other hand, using the list checker has its disadvantages. For example, if you use</p>

<pre><code>ANS(Interval(&quot;(-inf,3]&quot;)-&gt;cmp);</code></pre>

<p>and the student enters (-inf,3), she will get a message indicating that the type of interval is incorrect, while that would not be the case if</p>

<pre><code>ANS(List(Interval(&quot;(-inf,3]&quot;))-&gt;cmp);</code></pre>

<p>were used. (This is because the student doesn&#39;t know how many intervals there are, so saying that the type of interval is wrong would inform her that there is only one.)</p>

<p>The rule of thumb is: the individual checkers can give more detailed information about what is wrong with the student&#39;s answer; the list checker allows a wider range of answers to be given without giving away how many answers there are. If the student knows there&#39;s only one, use the individual checker; if there may or may not be more than one, use the list checker.</p>

<p>Note that you can form lists of formulas as well. The following all produce the same answer checker:</p>

<pre><code>ANS(List(Formula(&quot;x+1&quot;),Formula(&quot;x-1&quot;))-&gt;cmp);

ANS(Formula(&quot;x+1,x-1&quot;)-&gt;cmp); # easier

$f = Formula(&quot;x+1&quot;); $g = Formula(&quot;x-1&quot;);
ANS(List($f,$g)-&gt;cmp);

$x = Formula(&#39;x&#39;);
ANS(List($x+1,$x-1)-&gt;cmp);</code></pre>

<p>See the files in <i>pg/doc/MathObjects/problems</i> for more examples of using the parser&#39;s answer checkers.</p>

<h2 id="Controlling-the-Details-of-the-Answer-Checkers">Controlling the Details of the Answer Checkers</h2>

<p>The action of the answer checkers can be modified by passing flags to the <code>cmp()</code> method. For example:</p>

<pre><code>ANS(Real(pi)-&gt;cmp(showTypeWarnings=&gt;0));</code></pre>

<p>will prevent the answer checker from reporting errors due to the student entering the wrong type of answer (say a vector rather than a number).</p>

<h3 id="Flags-common-to-all-answer-checkers">Flags common to all answer checkers</h3>

<p>There are a number of flags common to all the checkers:</p>

<dl>

<dt><span style="white-space: nowrap;"><code>showTypeWarnings =&gt; 1 or 0</code></span></dt>
<dd>

<p>Show/don&#39;t show messages about student answers not being of the right type. (default: 1)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>showEqualErrors =&gt; 1 or 0</code></span></dt>
<dd>

<p>Show/don&#39;t show messages produced by trying to compare the professor and student values for equality, e.g., conversion errors between types. (default: 1)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>ignoreStrings =&gt; 1 or 0</code></span></dt>
<dd>

<p>Show/don&#39;t show type mismatch errors produced by strings (so that <code>NONE</code> will not cause a type mismatch in a checker looking for a list of numbers, for example). (default: 1)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>studentsMustReduceUnions =&gt; 1 or 0</code></span></dt>
<dd>

<p>Controls whether or not students answers are allowed to include overlapping, redundant, or uncombined intervals. (default: 1)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>showUnionReduceWarnings =&gt; 1 or 0</code></span></dt>
<dd>

<p>Do/don&#39;t show warnings for unreduced unions. This includes warnings about overlapping sets, uncombined intervals (like <code>(0,1] U [1,infinity]</code>), and repeated elements in sets. (default: 1)</p>

</dd>
</dl>

<p>In addition to these, the individual MathObject types have their own flags:</p>

<h3 id="Flags-for-Real--cmp">Flags for Real()-&gt;cmp</h3>

<dl>

<dt><span style="white-space: nowrap;"><code>ignoreInfinity =&gt; 1 or 0</code></span></dt>
<dd>

<p>Do/don&#39;t report type mismatches if the student enters an infinity. (default: 1)</p>

</dd>
</dl>

<h3 id="Flags-for-String--cmp">Flags for String()-&gt;cmp</h3>

<dl>

<dt><span style="white-space: nowrap;"><code>typeMatch =&gt; value</code></span></dt>
<dd>

<p>Specifies the type of object that the student should be allowed to enter (in addition the string). (default: <code>&#39;Value::Real&#39;</code>)</p>

</dd>
</dl>

<h3 id="Flags-for-Point--cmp">Flags for Point()-&gt;cmp</h3>

<dl>

<dt><span style="white-space: nowrap;"><code>showDimensionHints =&gt; 1 or 0</code></span></dt>
<dd>

<p>Show/don&#39;t show messages about the wrong number of coordinates. (default: 1)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>showCoordinateHints =&gt; 1 or 0</code></span></dt>
<dd>

<p>Show/don&#39;t show message about which coordinates are right. (default: 1)</p>

</dd>
</dl>

<h3 id="Flags-for-Vector--cmp">Flags for Vector()-&gt;cmp</h3>

<dl>

<dt><span style="white-space: nowrap;"><code>showDimensionHints =&gt; 1 or 0</code></span></dt>
<dd>

<p>Show/don&#39;t show messages about the wrong number of coordinates. (default: 1)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>showCoordinateHints =&gt; 1 or 0</code></span></dt>
<dd>

<p>Show/don&#39;t show message about which coordinates are right. (default: 1)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>promotePoints =&gt; 1 or 0</code></span></dt>
<dd>

<p>Do/don&#39;t allow the student to enter a point rather than a vector. (default: 1)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>parallel =&gt; 1 or 0</code></span></dt>
<dd>

<p>Mark the answer as correct if it is parallel to the professor&#39;s answer. Note that a value of 1 forces <code>showCoordinateHints</code> to be 0. (default: 0)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>sameDirection =&gt; 1 or 0</code></span></dt>
<dd>

<p>During a parallel check, mark the answer as correct only if it is in the same (not the opposite) direction as the professor&#39;s answer. (default: 0)</p>

</dd>
</dl>

<h3 id="Flags-for-Matrix--cmp">Flags for Matrix()-&gt;cmp</h3>

<dl>

<dt><span style="white-space: nowrap;"><code>showDimensionHints =&gt; 1 or 0</code></span></dt>
<dd>

<p>Show/don&#39;t show messages about the wrong number of coordinates. (default: 1)</p>

</dd>
</dl>

<p>The default for <code>showEqualErrors</code> is set to 0 for Matrices, since these errors usually are dimension errors, and that is handled separately (and after the equality check).</p>

<h3 id="Flags-for-Interval--cmp">Flags for Interval()-&gt;cmp</h3>

<dl>

<dt><span style="white-space: nowrap;"><code>showEndpointHints =&gt; 1 or 0</code></span></dt>
<dd>

<p>Do/don&#39;t show messages about which endpoints are correct. (default: 1)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>showEndTypeHints =&gt; 1 or 0</code></span></dt>
<dd>

<p>Do/don&#39;t show messages about whether the open/closed status of the end-points are correct (only shown when the end-points themselves are correct). (default: 1)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>requireParenMatch =&gt; 1 or 0</code></span></dt>
<dd>

<p>Do/don&#39;t require that the open/closed status of the end-points be correct. (default: 1)</p>

</dd>
</dl>

<h3 id="Flags-for-Set--cmp-Union--cmp-and-List--cmp">Flags for Set()-&gt;cmp, Union()-&gt;cmp, and List()-&gt;cmp</h3>

<p>All the flags from the <code>Real()-&gt;cmp</code>, plus:</p>

<dl>

<dt><span style="white-space: nowrap;"><code>showHints =&gt; 1 or 0</code></span></dt>
<dd>

<p>Do/don&#39;t show messages about which entries are incorrect. (default: <code>$showPartialCorrectAnswers</code>)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>showLengthHints =&gt; 1 or 0</code></span></dt>
<dd>

<p>Do/don&#39;t show messages about having the correct number of entries (only shown when all the student answers are correct but there are more needed, or all the correct answsers are among the ones given, but some extras were given). (default: <code>$showPartialCorrectAnswers</code>)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>partialCredit =&gt; 1 or 0</code></span></dt>
<dd>

<p>Do/don&#39;t give partial credit for when some answers are right, but not all. (default: <code>$showPartialCorrectAnswers</code>)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>ordered =&gt; 1 or 0</code></span></dt>
<dd>

<p>Give credit only if the student answers are in the same order as the professor&#39;s answers. (default: 0)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>entry_type =&gt; &#39;a (name)&#39;</code></span></dt>
<dd>

<p>The string to use in error messages about type mismatches. (default: dynamically determined from list)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>list_type =&gt; &#39;a (name)&#39;</code></span></dt>
<dd>

<p>The string to use in error messages about numbers of entries in the list. (default: dynamically determined from list)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>extra =&gt; $object</code></span></dt>
<dd>

<p>A MathObject to use for comparison to student-provided entries that do not match any of the correct answers in the list. Use in particular when the correct answer is a list of a single String (like <code>NONE</code>), and the expected type of elements in the list are complicated and need special syntax checking (e.g., for size of vectors).</p>

</dd>
<dt><span style="white-space: nowrap;"><code>typeMatch =&gt; value</code></span></dt>
<dd>

<p>Specifies the type of object that the student should be allowed to enter in the list (determines what constitutes a type mismatch error). (default: dynamically determined from list)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>requireParenMatch =&gt; 1 or 0</code></span></dt>
<dd>

<p>Do/don&#39;t require the parentheses in the student&#39;s answer to match those in the professor&#39;s answer exactly. (default: 1)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>removeParens =&gt; 1 or 0</code></span></dt>
<dd>

<p>Do/don&#39;t remove the parentheses from the professor&#39;s list as part of the correct answer string. This is so that if you use List() to create the list (which doesn&#39;t allow you to control the parens directly), you can still get a list with no parentheses. (default: 0 for <code>List()</code> and 1 for <code>Formula()</code>)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>implicitList =&gt; 1 or 0</code></span></dt>
<dd>

<p>Force/don&#39;t force single entry answers to be lists (even if they are already lists). This way, if you are asking for a list of lists, and the student enters a single list, it will be turned into a list of a single list, and will be checked properly against the correct answer. (default: 1)</p>

</dd>
</dl>

<h3 id="Flags-for-Formula--cmp">Flags for Formula()-&gt;cmp</h3>

<p>The flags for Formulas are dependent on the type of the result of the formula; the flags are taken from the class of the result as described above. In addition, Formulas take the following flags:</p>

<dl>

<dt><span style="white-space: nowrap;"><code>upToConstant =&gt; 1 or 0</code></span></dt>
<dd>

<p>For real-valued formulas, this controls whether the student&#39;s answer only needs to match the correct answer up to addition of a constant. (default: 0)</p>

</dd>
<dt><span style="white-space: nowrap;"><code>showDomainErrors =&gt; 1 or 0</code></span></dt>
<dd>

<p>If the test points for the function comparison reveals that the student answer is defined on a different domain from the correct answer (e.g., the student&#39;s answer is not defined at one of the test points), then this value determines whether or not a message is issued alerting the student to that fact. (default: 1)</p>

</dd>
</dl>

<h2 id="The-Context-and-Answer-Checkers">The Context and Answer Checkers</h2>

<p>Some things, like whether trig functions are allowed in the answer, are controlled through the <code>Context()</code> rather than the answer checker itself. For example,</p>

<pre><code>Context()-&gt;functions-&gt;disable(&#39;sin&#39;,&#39;cos&#39;,&#39;tan&#39;);</code></pre>

<p>would remove those three functions from use. One would need to remove <code>cot</code>, <code>sec</code>, <code>csc</code>, <code>arcsin</code>, <code>asin</code>, etc., to do this properly. Categories of functions can be removed all at once, e.g.</p>

<pre><code>Context()-&gt;functions-&gt;disable(&#39;Trig&#39;);</code></pre>

<p>would disable all trig functions, while</p>

<pre><code>Context()-&gt;functions-&gt;disable(&#39;All&#39;);
Context()-&gt;functions-&gt;enable(&#39;sqrt&#39;);</code></pre>

<p>would allow only the <code>sqrt</code> function to be used in student answers. The available categories are the following:</p>

<ul>

<li><p><code>SimpleTrig</code></p>

<p><code>sin</code>, <code>cos</code>, <code>tan</code>, <code>sec</code>, <code>csc</code>, <code>cot</code></p>

</li>
<li><p><code>InverseTrig</code></p>

<p><code>asin</code>, <code>acos</code>, <code>atan</code>, <code>asec</code>, <code>acsc</code>, <code>acot</code>, <code>arcsin</code>, <code>arccos</code>, <code>arctan</code>, <code>arcsec</code>, <code>arccsc</code>, <code>arccot</code>, <code>atan2</code></p>

</li>
<li><p><code>SimpleHyperbolic</code></p>

<p><code>sinh</code>, <code>cosh</code>, <code>tanh</code>, <code>sech</code>, <code>csch</code>, <code>coth</code></p>

</li>
<li><p><code>InverseHyperbolic</code></p>

<p><code>asinh</code>, <code>acosh</code>, <code>atanh</code>, <code>asech</code>, <code>acsch</code>, <code>acoth</code>, <code>arcsinh</code>, <code>arccosh</code>, <code>arctanh</code>, <code>arcsech</code>, <code>arccsch</code>, <code>arccoth</code></p>

</li>
<li><p><code>Numeric</code></p>

<p><code>log</code>, <code>log10</code>, <code>exp</code>, <code>sqrt</code>, <code>abs</code>, <code>int</code>, <code>sgn</code>, <code>ln</code>, <code>logten</code></p>

</li>
<li><p><code>Vector</code></p>

<p><code>norm</code>, <code>unit</code></p>

</li>
<li><p><code>Complex</code></p>

<p><code>arg</code>, <code>mod</code>, <code>Re</code>, <code>Im</code>, <code>conj</code></p>

</li>
<li><p><code>Hyperbolic</code></p>

<p>all of <code>SimpleHyperbolic</code> and <code>InverseHyperbolic</code></p>

</li>
<li><p><code>Trig</code></p>

<p>all of <code>SimpleTrig</code>, <code>InverseTrig</code>, and <code>Hyperbolic</code></p>

</li>
<li><p><code>All</code></p>

<p>all of <code>Trig</code>, <code>Numeric</code>, <code>Vector</code>, and <code>Complex</code></p>

</li>
</ul>

<p>Note that some functions can be obtained via operators (e.g., <code>abs(x)</code> can be obtained via <code>|x|</code> and <code>sqrt(x)</code> can be obtained by <code>x^(1/2)</code>, so you might need to remove more than just the named functions to limit these operations).</p>

<p>Which arithmetic operations are available is controlled through <code>Context()-&gt;operations</code>. For example,</p>

<pre><code>Context()-&gt;operations-&gt;undefine(&#39;^&#39;,&#39;**&#39;);</code></pre>

<p>would disable the ability for students to enter powers. Note that multiplication and division have several forms (in order to make a non-standard precedence that allows things like <code>sin(2x)</code> to be entered as <code>sin 2x</code>). So if you want to disable them you need to include all of them. E.g.,</p>

<pre><code>Context()-&gt;operations-&gt;undefine(&#39;*&#39;,&#39; *&#39;,&#39;* &#39;);
Context()-&gt;operations-&gt;undefine(&#39;/&#39;,&#39; /&#39;,&#39;/ &#39;,&#39;//&#39;);</code></pre>

<p>would be required in order to make multiplication and division unavailable.</p>

<p>Finally, absolute values are treated as a specialized form of parenthesis, so to remove them, use</p>

<pre><code>Context()-&gt;parens-&gt;remove(&#39;|&#39;);</code></pre>

<p>The <i>pg/macros</i> directory contains a number of predefined contexts that limit the operations that can be performed in a student answer. For example, the <i>contextLimitedNumeric.pl</i> file defines contexts in which students can enter numbers, but no operations, so they would have to reduce their answer to a single number by hand. There are limited contexts for complex numbers, points, and vectors, and there are also specialized contexts for entering polynomials, or where powers are restricted in various ways.</p>

<h2 id="Tolerances-and-Limits">Tolerances and Limits</h2>

<p>The tolerances used in comparing numbers are part of the Context as well. You can set these via:</p>

<pre><code>Context()-&gt;flags-&gt;set(
  tolerance    =&gt; .0001,       # the relative or absolute tolerance
  tolType      =&gt; &#39;relative&#39;,  # or &#39;absolute&#39;
  zeroLevel    =&gt; 1E-14,       # when to use zeroLevelTol
  zeroLevelTol =&gt; 1E-12,       # smaller than this matches zero
                               #  when one of the two is less
                               #  than zeroLevel
  limits       =&gt; [-2,2],      # limits for variables in formulas
  num_points   =&gt; 5,           # the number of test points
);</code></pre>

<p>Note that for testing formulas, you can override these values by setting these fields of the formula itself:</p>

<pre><code>$f = Formula(&quot;sqrt(x-10)&quot;);
$f-&gt;{limits} = [10,12];

$f = Formula(&quot;log(xy)&quot;);
$f-&gt;{limits} = [[.1,2],[.1,2]]; # x and y limits</code></pre>

<p>You can also specify the test points explicitly:</p>

<pre><code>$f = Formula(&quot;sqrt(x-10)&quot;);
$f-&gt;{test_at} = [[11],[11.5],[12]];  # use these plus random ones

$f = Formula(&quot;log(xy)&quot;);
$f-&gt;{test_points} = [[.1,.1],[.1,.5],[.1,.75],
                     [.5,.1],[.5,.5],[.5,.75]];  # test only at these</code></pre>

<p>You can specify the value at the same time you create the object, as in</p>

<pre><code>$f = Formula(&quot;sqrt(x-1)&quot;)-&gt;with(limits=&gt;[10,12]);</code></pre>

<p>It is also possible to set the limits of variables in the context itself,</p>

<pre><code>Context()-&gt;variables-&gt;set(x =&gt; {limits =&gt; [10,12]});</code></pre>

<p>or when a variable is created in the Context,</p>

<pre><code>Context()-&gt;variables-&gt;add(t =&gt; [&#39;Real&#39;,limits=&gt;[1,2]]);</code></pre>

<p>or even when the answer checker is specified,</p>

<pre><code>ANS($f-&gt;cmp(limits=&gt;[10,12]));</code></pre>

<h2 id="Custom-Answer-Checkers">Custom Answer Checkers</h2>

<p>While the built-in answer checkers do a good job of testing a student response for agreement with a given correct answer, sometimes an answer may require a more sophisticated or customized check. For example, you might ask a student to provide a solution to a given implicit equation for which there are infinitely many solutions and would like to count any of them as correct. You can do this by providing your own answer checker as a parameter to a MathObject answer checker. This lets you get the advantage of the MathObject parsing, syntax checking, type checking, and error messages, while still giving you the control of deciding when the student&#39;s answer is correct.</p>

<p>You do this by providing a <code>checker</code> subroutine, as in the following example:</p>

<pre><code>Context(&quot;Point&quot;);
$a = random(2,10,1);
$x = random(-5,5,1);
$y = $a - $x;

BEGIN_TEXT
Find a point \((x,y)\) that is a solution to \(x+y=$a\).
$PAR
\((x,y)\) = \{ans_rule(15)\}
END_TEXT

ANS(Point($x,$y)-&gt;cmp(
  showCoordinateHints =&gt; 0,                # doesn&#39;t make sense to give these
  checker =&gt; sub {
    my ($correct,$student,$ansHash) = @_;  # get correct and student MathObjects
    my ($sx,$sy) = $student-&gt;value;        # get coordinates of student answer
    return ($sx + $sy == $a ? 1 : 0);      # return 1 of correct, 0 otherwise
  }
));</code></pre>

<p>The subroutine that is given as the value of the <code>checker</code> parameter is called when the student has typed an answer that parses properly and is compatible with a point, so you don&#39;t have to worry about type-checking the student answer yourself, and are guaranteed to have a MathObject to work with.</p>

<p>Note that your answer checker is tied to a given MathObject, so the type checking and error messages are appropriate for that type of object. Also, this is what will be shown as the correct answer if the student requests answers after the due date, so you should be sure that you provide an actual correct answer, even if you don&#39;t use <code>$correct</code> within your checker.</p>

<p>Your checker subroutiune is passed three items, the correct answer (as a MathObject), the student&#39;s answer (as a MathObject), and a reference to the AnswerHash that is being used to process this answer. In the example above, <code>$correct</code> will be the <code>Point($x,$y)</code> that was used to create the original MathObject for the answer checker, and <code>$student</code> will be the point that the student typed.</p>

<p>The answer hash (<code>$ansHash</code>), holds additional data about the answer checker and the student&#39;s answer. That data includes all the flags passed to the answer checker; e.g., in the example above, <span style="white-space: nowrap;"><code>$ansHash-&gt;{showCoordinateHints}</code></span> will be <code>0</code>, while <span style="white-space: nowrap;"><code>$ansHash-&gt;{showTypeWarnings}</code></span> will be 1 (the default). Other fields that are useful include</p>

<dl>

<dt><span style="white-space: nowrap;"><code>$ansHash-&gt;{correct_ans}</code></span></dt>
<dd>

<p>The correct answer string</p>

</dd>
<dt><span style="white-space: nowrap;"><code>$ansHash-&gt;{isPreview}</code></span></dt>
<dd>

<p>Whether the &quot;Preview&quot; button was pressed or not (you might want to limit error messages when this is true).</p>

</dd>
<dt><span style="white-space: nowrap;"><code>$ansHash-&gt;{original_student_ans}</code></span></dt>
<dd>

<p>The unmodified string originally typed by the student. It has not been processed in any way.</p>

</dd>
<dt><span style="white-space: nowrap;"><code>$ansHash-&gt;{student_formula}</code></span></dt>
<dd>

<p>The Formula obtained from parsing the student answer. If it is a constant value, then <code>$student</code> is the result of evaluating this formula (i.e., it will be a Real or Point or some other MathObject rather than a Formula); if it is not constant, then <code>$student</code> will be this Formula.</p>

</dd>
<dt><span style="white-space: nowrap;"><code>$ansHash-&gt;{student_value}</code></span></dt>
<dd>

<p>The value passed to <code>$student</code>.</p>

</dd>
<dt><span style="white-space: nowrap;"><code>$ansHash-&gt;{correct_value}</code></span></dt>
<dd>

<p>The value passed to <code>$correct</code>.</p>

</dd>
</dl>

<p>The return value of your checker should be a value between 0 and 1 that indicates how much credit the student&#39;s answer should receive. Use 1 for full credit, .5 for 50% credit, and so on.</p>

<p>Error messages can be generated via the <code>Value-&gt;Error()</code> function. For example,</p>

<pre><code>Value-&gt;Error(&quot;Your value should be positive&quot;) if $student &lt;= 0;</code></pre>

<p>Note that this function will cause the checker to return with an error condition, so there is no need to return a score in this case.</p>

<h3 id="List-based-Answer-Checkers">List-based Answer Checkers</h3>

<p>The built-in answer checkers for the List, Union, and Set classes are a bit more complicated than those for the other classes, because the order of elements in the List (or Intervals in a Union, or elements of a Set) usually doesn&#39;t matter. If you provide a <code>checker</code> routine for one of these types of MathObjects, it does not refer to the list as a whole, but to the individual elements in the list. Management of the list and determining how many elements are matched, what the partial credit should be, and what error messages to produce is all handled by the main list answer checker. You only provide a routine that determines when a student answer matches a correct answer. Your checker will be called repeatedly on the various combinations of student and correct answers to determine if the student list matches the correct list (regardless of order).</p>

<p>When the <code>checker</code> is called from the list checker, it has two additional paramters:</p>

<pre><code>checker =&gt; sub {
  my ($correct,$student,$ansHash,$nth,$value) = @_;
  ...
}</code></pre>

<p>Here <code>$nth</code> is a word indicating which student answer is being tested (e.g., for the third element in the student&#39;s list, <code>$nth</code> will be <code>&quot; third&quot;</code> (note the leading space). This can be used in error messages, for example, to help the student identify where an error occurred. The <code>$value</code> is the name of the type of object that is in the list, e.g., <code>&quot;point&quot;</code>. So you could use <code>&quot;Your$nth $value is not correct&quot;</code> as an error message in order to get something like <code>&quot;Your third point is incorrect&quot;</code> as the output.</p>

<p>As usual, you can use <code>Value-&gt;Error()</code> to generate an error message. The list checker will trap it and put it int he message area preceded by &quot;There is a problem with your nth answer:&quot; (where &quot;nth&quot; is replaced by the proper word for the answer that produced the error message. If you want to produce a message that doesn&#39;t include this prefix, use</p>

<pre><code>$correct-&gt;{context}-&gt;setError(&quot;message&quot;,&quot;&quot;,undef,undef,$Value::CMP_WARNING);
return 0;</code></pre>

<p>where &quot;message&quot; is the error message you want to produce.</p>

<p>If you want to act on the List (or Union or Set) as a whole, then you need to use the <code>list_checker</code> parameter instead. This specifies a subtroutine that will handle checking of the entire list, overriding the default list checking. That means you will be responsible for dealing with the possibly different order of the student answers from the correct answer, providing error messages about individual entries in the list, and so on.</p>

<p>The <code>list_checker</code> gets called with four parameters: a reference to an array containing the list of correct answers, a reference to an array of the student answers, a reference to the AnswerHash, and a string containing the name of the type of elements expected (for use in error messages). So a list checker looks like</p>

<pre><code>list_checker =&gt; sub {
  my ($correct,$student,$ansHash,$value) = @_;
  ...
}</code></pre>

<p>You can refer to the individual entries in <code>$correct</code> or <code>$student</code> as <code>$correct-&gt;[$i]</code> or <code>$student-&gt;[$i]</code>, where <code>$i</code> is an integer representing the position within the list (the first entry is numbered 0 not 1).</p>

<p>Note that in a <code>list_checker</code> for a List object, you will have to do type checking yourself to check if the types of the entries are correct, since a list can consist of any type of elements.</p>

<p>The <code>list_checker</code> should return an array consisting of the nuber of student entries that are correct followed by any error messages that should be displayed (each on a separate line in the messages section).</p>

<p>Here is an example of a list checker:</p>

<pre><code>Context(&quot;Point&quot;);

BEGIN_TEXT
Three distinct points \((x,y)\) that satisfy the equation \(x+y=5\) are:
\{ans_rule(20)\}
END_TEXT

ANS(List(&quot;(0,5),(1,4),(2,3)&quot;)-&gt;cmp(list_checker =&gt; sub {
  my ($correct,$student,$ansHash,$value) = @_;
  my $n = scalar(@$student);  # number of student answers
  my $score = 0;              # number of correct student answers
  my @errors = ();            # stores error messages
  my $i, $j;                  # loop counters

  #
  #  Loop though the student answers
  ##
  for ($i = 0; $i &lt; $n; $i++) {
    my $ith = Value::List-&gt;NameForNumber($i+1);
    my $p = $student-&gt;[$i];   # i-th student answer
    #
    #  Check that the student&#39;s answer is a point
    #
    if ($p-&gt;type ne &quot;Point&quot;) {
       push(@errors,&quot;Your $ith entry is not a point&quot;);
       next;
    }
    #
    #  Check that the point hasn&#39;t been given before
    #
    for ($j = 0, $used = 0; $j &lt; $i; $j++) {
      if ($student-&gt;[$j]-&gt;type eq &quot;Point&quot; &amp;&amp; $student-&gt;[$j] == $p) {
        push(@errors,&quot;Your $ith point is the same as a previous one&quot;) unless $ansHash-&gt;{isPreview};
        $used = 1; last;
      }
    }
    #
    #  If not already used, check that it satisfies the equation
    #    and increase the score if so.
    #
    if (!$used) {
      my ($a,$b) = $p-&gt;value;
      if ($a + $b == 5) {$score++} else {
        push(@errors,&quot;Your $ith point is not correct&quot;) unless $ansHash-&gt;{isPreview}
      }
    }
  }
  #
  #  Check that there are the right number of answers
  #
  if (!$ansHash-&gt;{isPreview}) {
    push(@errors,&quot;You need to provide more points&quot;) if $i &lt; 3;
    push(@errors,&quot;You have given too many points&quot;) if $score &gt; 3 &amp;&amp; $i != $score;
  }
  return ($score,@errors);
}));</code></pre>

<p>As you can see, list checkers are more complicated than checkers for the other types of data. But for certain situations like the one above, they can be indispensible.</p>

<h3 id="Set-and-Union-Answer-Checkers">Set and Union Answer Checkers</h3>

<p>Since Sets and Unions are unordered lists of Reals or Intervals, they act a lot like lists. If you provide a <code>checker</code> for one of these, it works like the List checker: it is applied to the individual entries in the Set or the individual intervals in a Union. You may want to write a checker that works with the entire Set or Union at once, however. In that case, you need to use a <code>list_checker</code> in which you obtain the full Set or Union from <code>$ansHash</code>. For example:</p>

<pre><code>Context(&quot;Interval&quot;);

BEGIN_TEXT
Find a union of disjoint intervals that properly contains
the numbers 0 and 5:
\{ans_rule(20)\}
END_TEXT

ANS(Union(&quot;(-1,1) U (4,infinity)&quot;)-&gt;cmp(list_checker =&gt; sub {
  my ($correct,$student,$ansHash) = @_;
  my $U = $ansHash-&gt;{student_value}; # complete student answer as MathObject
  if ($U-&gt;type ne &quot;Union&quot;) {return (0,&quot;Your answer should be a union of intervals&quot;)}
  my $n = scalar(@$student); # number of intervals
  my $S = Set(0,5);
  return ($U-&gt;contains($S) &amp;&amp; $U != $S ? $n : 0);  # number of intervals correct
}));</code></pre>

<p>Note that the return value is the score followed by any error messages, and that the score is the number of intervals in the student&#39;s answer that are correct, which is why this checker returns <code>$n</code>$ when the answer is correct.</p>

<p>More error checking might be desired, here. For example, since a Union can be of Intervals or Sets, we might want to check that all the student&#39;s entries in the Union are actually intervals (the current version allows Sets). Note thta because the <code>studentsMustReduceUnions</code> parameter is 1 by default, we don&#39;t have to check for disjoint intervals. On the other hand, that flag also requires intervals to be merged into one if they could be, e.g., <code>(0,1] U (1,2)</code>. We might want to work harder to allow that, since it <i>is</i> a disjoint union. We could also give more error messages to help the student work through a wrong answer. For example, we could check which point isn&#39;t covered and report that.</p>

		</div>
	</div>
</body>
</html>
